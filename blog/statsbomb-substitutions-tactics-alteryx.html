<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StatsBomb Substitutions &amp;amp; Tactics (Alteryx) - CJ Mayes</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        *,::after,::before{
            box-sizing: border-box;
        }
        body,html{
            font-family: "Plus Jakarta Sans", sans-serif;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            margin: 0;
            padding: 0;
            font-weight: 400;
            line-height: 1.5;
            font-size: 15px;
            color: #212529;
            word-wrap: break-word;
        }
        html{
            overflow-x: hidden;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        header {
            border-bottom: 1px solid #e9ecef;
            padding: 30px 0;
            margin-bottom: 40px;
        }
        header h1 {
            font-size: 32px;
            font-weight: 600;
            margin: 0;
            color: #212529;
        }
        header h1 a {
            color: #212529;
            text-decoration: none;
        }
        header h1 a:hover {
            opacity: 0.8;
        }
        header p {
            margin: 8px 0 0 0;
            font-size: 15px;
            color: #6c757d;
            font-weight: 400;
        }
        nav {
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        nav a {
            color: #212529;
            text-decoration: none;
            font-size: 15px;
            font-weight: 500;
            margin-right: 30px;
            transition: opacity 0.2s;
        }
        nav a:hover {
            opacity: 0.7;
        }
        main {
            margin-bottom: 60px;
        }
        article {
            max-width: 800px;
            margin: 0 auto;
        }
        article h1 {
            font-size: 36px;
            font-weight: 600;
            margin-bottom: 24px;
            color: #212529;
            line-height: 1.2;
        }
        article h2 {
            font-size: 28px;
            font-weight: 600;
            margin-top: 40px;
            margin-bottom: 16px;
            color: #212529;
            line-height: 1.3;
        }
        article h3 {
            font-size: 22px;
            font-weight: 600;
            margin-top: 32px;
            margin-bottom: 12px;
            color: #212529;
        }
        article p {
            margin-bottom: 16px;
            font-size: 15px;
            line-height: 1.6;
            color: #212529;
        }
        article img, article figure {
            max-width: 100%;
            height: auto;
            margin: 32px 0;
            border-radius: 4px;
        }
        article figure {
            margin: 32px 0;
        }
        article figure img {
            display: block;
            margin: 0 auto;
        }
        article a {
            color: #212529;
            text-decoration: underline;
            text-decoration-color: #6c757d;
            text-underline-offset: 3px;
        }
        article a:hover {
            text-decoration-color: #212529;
        }
        footer {
            text-align: center;
            padding: 40px 20px;
            margin-top: 60px;
            border-top: 1px solid #e9ecef;
            color: #6c757d;
            font-size: 14px;
        }
        .post-list {
            list-style: none;
            padding: 0;
        }
        .post-list li {
            margin-bottom: 32px;
            padding-bottom: 32px;
            border-bottom: 1px solid #e9ecef;
        }
        .post-list li:last-child {
            border-bottom: none;
        }
        .post-list h2 {
            margin-bottom: 8px;
            font-size: 22px;
        }
        .post-list a {
            color: #212529;
            text-decoration: none;
        }
        .post-list a:hover {
            text-decoration: underline;
            text-decoration-color: #212529;
        }
        .post-list p {
            color: #6c757d;
            font-size: 14px;
            margin-top: 8px;
        }
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            article h1 {
                font-size: 28px;
            }
            article h2 {
                font-size: 24px;
            }
            header h1 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1><a href="blog.html">CJ Mayes</a></h1>
                <p>London, United Kingdom</p>
        </div>
    </header>
    
    <div class="container">
        <nav>
            <a href="blog.html">Blog</a>
        </nav>
        
        <main>
            <article>
                <h1>StatsBomb Substitutions &amp; Tactics (Alteryx)</h1>Hi all,

An Alteryx flow blog this week looking at preparing data ready for use.

As many of you are aware, Statsbomb have made some data free for use within the public domain. Todays tutorial we will revisit the Women's World Cup and look at recording substitutions and changes in tactics as part of the match events data that can be pulled directly from their Git Repo.

If you'd like to follow along, by all means the workflow, starting and end dataset are all found in the repository.

It is worth mentioning there is an easier way of pulling back some of the records, such as the line up and that is through python. You can find how to convert the json into a readable format on the<a href="https://mplsoccer.readthedocs.io/en/latest/gallery/statsbomb/plot_statsbomb_data.html"><strong> mplsoccer website</strong></a>, it consists of the following line of code
<pre><span class="n">df_lineup</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">lineup</span><span class="p">(</span><span class="mi">7478</span><span class="p">)</span></pre>
Anyway. Here I want to help those without a coding background to make their own transformations.

Lets look at the workflow and data.

We want 3 things from today:
<ol>
 	<li>To log every substitution</li>
 	<li>To log whether that substitution then impacts a change in tactics</li>
 	<li>To create a condensed output file to be able to showcase those 2 things occurring.</li>
</ol>
Connect to the <strong>match events data.</strong>

<img class="alignnone size-full wp-image-7185" src="../uploads/2023/09/WFCapture.png" alt="" width="1691" height="441" />

First thing we do in the top of the flow is filter out some of the noise. Always important as generally we don't want to bring fields we don't need.

<img class="alignnone size-full wp-image-7186" src="../uploads/2023/09/TactTCapture.png" alt="" width="799" height="460" />

First thing to notice is the tactics field is stored in a json format. The cell is also truncated meaning we are at risk of the string cutting off some of the details.

In this case we click back on our match_events input and change the field length to be longer than the json would be (in this case i set it to 4000)

We then look to filter our data to only the tactics.

<img class="alignnone size-full wp-image-7188" src="../uploads/2023/09/TacticsCapture.png" alt="" width="734" height="144" />

Here is a sample example of the tactics field

{'formation': 4231, 'lineup': [{'player': {'id': 45295, 'name': 'Catalina Thomas Coll Lluch'}, 'position': {'id': 1, 'name': 'Goalkeeper'}, 'jersey_number': 23}, {'player': {'id': 46639, 'name': 'Ona Batlle Pascual'}, 'position': {'id': 2, 'name': 'Right Back'}, 'jersey_number': 2}, {'player': {'id': 10165, 'name': 'Irene Paredes Hernandez'}, 'position': {'id': 3, 'name': 'Right Center Back'}, 'jersey_number': 4}, {'player': {'id': 32694, 'name': 'Laia Codina Panedas'}, 'position': {'id': 5, 'name': 'Left Center Back'}, 'jersey_number': 14}, {'player': {'id': 49836, 'name': 'Olga Carmona GarcÃ­a'}, 'position': {'id': 6, 'name': 'Left Back'}, 'jersey_number': 19}, {'player': {'id': 49835, 'name': 'Teresa Abelleira DueÃ±as'}, 'position': {'id': 11, 'name': 'Left Defensive Midfield'}, 'jersey_number': 3}, {'player': {'id': 15284, 'name': 'Aitana Bonmati Conca'}, 'position': {'id': 13, 'name': 'Right Center Midfield'}, 'jersey_number': 6}, {'player': {'id': 50151, 'name': 'Alba MarÃ­a Redondo Ferrer'}, 'position': {'id': 17, 'name': 'Right Wing'}, 'jersey_number': 17}, {'player': {'id': 10151, 'name': 'Jennifer Hermoso Fuentes'}, 'position': {'id': 19, 'name': 'Center Attacking Midfield'}, 'jersey_number': 10}, {'player': {'id': 10161, 'name': 'MarÃ­a Francesca Caldentey Oliver'}, 'position': {'id': 21, 'name': 'Left Wing'}, 'jersey_number': 8}, {'player': {'id': 222682, 'name': 'Salma Paralluelo Ayingono'}, 'position': {'id': 23, 'name': 'Center Forward'}, 'jersey_number': 18}]}

Now whilst I would love to use the Json parse too to solve this challenge, it doesn't always work as expected depending on the format of the json (not to mention id have to do a string replace for the quotations to be double quotes), so we have to turn to some regex to be able to split the different parts of the data we need.

At this point a major thank you goes to my colleague Filip Rutkowski. I don't have the coding patience I use to... ha. The regular expression needed is (.*)\[(.*)]

(.*) - This part matches zero or more occurrences of any character (except newline) and captures it within a group. The . matches any character, and * quantifier means "zero or more occurrences". So, (.*) captures any sequence of characters.

\[(.*)] - This part matches the opening square bracket [, followed by zero or more occurrences of any character (except newline), and captures it within a group. The . matches any character, and * quantifier means "zero or more occurrences". So, (.*) captures any sequence of characters within the square brackets. Finally, \] matches the closing square bracket ].

What this will do is trim off the start to the formation and line up part of the string.

<img class="alignnone size-full wp-image-7191" src="../uploads/2023/09/FormulaCapture.png" alt="" width="735" height="550" />

By following the above formula tools and a further regex column to split on the : delimiter, we can start to split out field names and values like below

<img class="alignnone size-full wp-image-7193" src="../uploads/2023/09/12Capture.png" alt="" width="1429" height="255" />

It's then a case of using the cross tab to transform the data.

<img class="alignnone size-full wp-image-7195" src="../uploads/2023/09/StartingXI.png" alt="" width="1233" height="562" />

See how we now have the starting 11 for each team. Scrolling further we see that it also has changes in tactics too and what the 11 players for that would look like.

The final thing we want to do is add in the substitutions, to add context to the tactics that take place.

You will see the bottom half of the flow looks at where type = Substitution.

We then do some renaming conventions to both our parts of the flow before doing a union to glue them together

<img class="alignnone size-full wp-image-7197" src="../uploads/2023/09/SubCapture.png" alt="" width="1448" height="458" />

Take the above example, we see Chloe Kelly and Lauren James sub on at half time and the tactic / line up change and we log both those events in our final dataset.

Hopefully you enjoyed some of the complexities

Taking It Further:
<ul>
 	<li>Create a minute by minute dataset for which players are on the pitch</li>
 	<li>Consider metrics on how you could measure the impact of a substitution</li>
 	<li>Try convert the alteryx workflow into a code of your choosing</li>
</ul>
<strong>LOGGING OFF,</strong>

<strong>CJ</strong>
            </article>
        </main>
    </div>
    
    <footer>
        <p>&copy; 2025 CJ Mayes. All rights reserved.</p>
    </footer>
</body>
</html>